<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Key Logger with Coord Mapping & Speed</title>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Mapping from key to coordinate numbers (tip, left, right)
      const mapping = {
        "u": { tip: 0,  left: -10,  right: 0  },  // Motor Y up
        "j": { tip: 0,  left: 10, right: 0  },  // Motor Y down
        "i": { tip: 0,  left: 0,   right: -10 },  // Motor Z up
        "k": { tip: 0,  left: 0,   right: 10},  // Motor Z down
        "y": { tip: -10, left: 0,   right: 0  },  // Motor X up
        "h": { tip: 10,  left: 0,   right: 0  }   // Motor X down
      };

      document.addEventListener("keydown", function(event) {
        let key = event.key.toLowerCase();
        let commandStr = "";
        if (mapping.hasOwnProperty(key)) {
          // Get the current speed from the input field.
          const speed = document.getElementById("speed").value || "0";
          const coords = mapping[key];
          // Build the coordinate command: (tip,left,right,speed)
          commandStr = `(${coords.tip},${coords.left},${coords.right},${speed})`;
          document.getElementById("lastKey").textContent = commandStr;
          
          // Send the command to your FastAPI server
          fetch(`https://c04c-181-81-79-157.ngrok-free.app/command?cmd=${encodeURIComponent(commandStr)}`, {
            method: "POST"
          }).catch(error => console.error("Error sending command:", error));
        } else {
          // For unmapped keys, simply display the uppercase key.
          document.getElementById("lastKey").textContent = key.toUpperCase();
        }
      });
    });
  </script>
</head>
<body>
  <h1>Last Command Sent:</h1>
  <h2 id="lastKey">None</h2>
  <div>
    <label for="speed">Motor Speed:</label>
    <input type="number" id="speed" value="128000">
  </div>
</body>
</html>
